<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微分法入門</title>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            color: #1a237e;
            margin-top: 1.5em;
        }
        h1 {
            text-align: center;
            border-bottom: 2px solid #1a237e;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            border-left: 5px solid #1a237e;
            padding-left: 15px;
        }
        .formula {
            background-color: #f0f0f8;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            overflow-x: auto;
            text-align: center;
            font-size: 1.1em;
            /* MathJax 用スタイルを追加 */
            font-family: 'Latin Modern Math', 'Cambria Math', serif;
        }
        .note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 10px 15px;
            margin: 15px 0;
        }
        .example {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 10px 15px;
            margin: 15px 0;
        }
        .figure {
            text-align: center;
            margin: 25px 0;
        }
        .figure img, .figure svg {
            max-width: 100%;
            border-radius: 5px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16);
            background-color: #fff; /* SVG background */
        }
        .figure figcaption {
            margin-top: 10px;
            font-style: italic;
            color: #666;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: center; /* 数式が多いので中央揃えに */
            vertical-align: middle;
        }
        th {
            background-color: #e8eaf6;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f5f5f5;
        }
        .timeline {
            position: relative;
            max-width: 800px;
            margin: 40px auto; /* 上下のマージンを追加 */
            padding: 20px 0;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 4px;
            background-color: #1a237e;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -2px;
        }
        .timeline-container {
            position: relative;
            width: 50%;
            padding: 10px 40px;
            box-sizing: border-box;
        }
        .timeline-container.left {
            left: 0;
        }
        .timeline-container.right {
            left: 50%;
        }
        .timeline-content {
            padding: 15px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            position: relative; /* Arrow pseudo-element */
        }
        .timeline-container::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: white;
            border: 4px solid #1a237e;
            border-radius: 50%;
            top: 25px; /* Adjusted top position */
            z-index: 1;
        }
        .timeline-container.left::after {
            right: -12px; /* Adjusted position */
        }
        .timeline-container.right::after {
            left: -12px; /* Adjusted position */
        }
        /* Timeline arrows */
        .timeline-container.left .timeline-content::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 28px;
            width: 0;
            z-index: 1;
            right: -10px;
            border: medium solid white;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent white;
        }
        .timeline-container.right .timeline-content::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 28px;
            width: 0;
            z-index: 1;
            left: -10px;
            border: medium solid white;
            border-width: 10px 10px 10px 0;
            border-color: transparent white transparent transparent;
        }

        @media screen and (max-width: 600px) {
            .timeline::after {
                left: 31px;
            }
            .timeline-container {
                width: 100%;
                padding-left: 70px;
                padding-right: 25px;
            }
            .timeline-container.right {
                left: 0%;
            }
            .timeline-container.left::after, .timeline-container.right::after {
                left: 19px; /* Adjusted position */
            }
            .timeline-container.left .timeline-content::before,
            .timeline-container.right .timeline-content::before {
                left: -10px;
                border-width: 10px 10px 10px 0;
                border-color: transparent white transparent transparent;
            }
             .timeline-container.left .timeline-content::before {
                right: auto; /* Reset right property */
            }
        }
        /* MathJax/KaTeX support */
        .katex-display { overflow-x: auto; overflow-y: hidden; }
        
        /* 元のスタイルとの互換性のためのクラス */
        .theorem {
            background-color: #e8f4f8;
            padding: 15px;
            border-left: 5px solid #3498db;
            margin: 20px 0;
        }
        .proof {
            background-color: #f8f9fa;
            padding: 15px;
            border-left: 5px solid #7f8c8d;
            margin: 20px 0;
        }
        .definition {
            background-color: #e8f8f5;
            padding: 15px;
            border-left: 5px solid #16a085;
            margin: 20px 0;
        }
        .graph { /* This class seems unused, .figure is used for graphs */
            text-align: center;
            margin: 20px 0;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f1f1f1;
            padding: 2px 5px;
            border-radius: 3px;
        }
    </style>
    <!-- KaTeX for rendering math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558fYv3mQPFEpCREUQueRFCZrCXCtiKU8aNVbN9ODdVcN3BwCAJ6pcBb" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                // customised options
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ]
            });
        });
    </script>
</head>
<body>

    <h1>微分法入門</h1>

    <h2>1: 三角関数$\cos(x)$, $\sin(x)$の性質</h2>
    <p>三角関数の微分に関する基本的な性質は以下の通りです。</p>
    <div class="formula">
        $(\cos x)' = -\sin x$
    </div>
    <div class="formula">
        $(\sin x)' = \cos x$
    </div>

    <div class="figure">
        <svg width="500" height="300" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="50" y1="150" x2="450" y2="150" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="50" y1="30" x2="50" y2="270" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            <!-- Ticks and labels for X-axis -->
            <text x="45" y="145" font-size="10" text-anchor="end">0</text>
            <line x1="50" y1="145" x2="50" y2="155" stroke="#333" stroke-width="1"/>
            <text x="150" y="165" font-size="10" text-anchor="middle">$\pi/2$</text>
            <line x1="150" y1="145" x2="150" y2="155" stroke="#333" stroke-width="1"/>
            <text x="250" y="165" font-size="10" text-anchor="middle">$\pi$</text>
            <line x1="250" y1="145" x2="250" y2="155" stroke="#333" stroke-width="1"/>
            <text x="350" y="165" font-size="10" text-anchor="middle">$3\pi/2$</text>
            <line x1="350" y1="145" x2="350" y2="155" stroke="#333" stroke-width="1"/>
            <text x="450" y="165" font-size="10" text-anchor="middle">$2\pi$</text>
            <line x1="450" y1="145" x2="450" y2="155" stroke="#333" stroke-width="1"/>
            <!-- Ticks and labels for Y-axis -->
            <text x="40" y="55" font-size="10" text-anchor="end">1</text>
            <line x1="45" y1="50" x2="55" y2="50" stroke="#333" stroke-width="1"/>
            <text x="40" y="255" font-size="10" text-anchor="end">-1</text>
            <line x1="45" y1="250" x2="55" y2="250" stroke="#333" stroke-width="1"/>
            
            <!-- sin(x) in red -->
            <path d="M 50 150 Q 100 50, 150 150 T 250 150 Q 300 250, 350 150 T 450 150" stroke="red" fill="none" stroke-width="2"/>
            <!-- cos(x) in blue -->
            <path d="M 50 50 Q 100 150, 150 150 T 250 50 Q 300 150, 350 150 T 450 50" stroke="blue" fill="none" stroke-width="2"/>
            
            <!-- Legend -->
            <rect x="380" y="35" width="60" height="40" fill="#fff" stroke="#ccc"/>
            <line x1="390" y1="50" x2="405" y2="50" stroke="red" stroke-width="2"/>
            <text x="410" y="55" font-size="10">sin(x)</text>
            <line x1="390" y1="65" x2="405" y2="65" stroke="blue" stroke-width="2"/>
            <text x="410" y="70" font-size="10">cos(x)</text>
        </svg>
        <figcaption>図1: $\sin(x)$ と $\cos(x)$ のグラフ ($0 \le x \le 2\pi$)</figcaption>
    </div>

    <p>正接関数 $\tan(x)$ は次のように定義されます。</p>
    <div class="formula">
        $\tan(x) := \frac{\sin x}{\cos x}$
    </div>
    <p>$\tan(x)$ は $\cos x = 0$ となる点 (つまり $x = \frac{\pi}{2} + n\pi$, $n$ は整数) では定義されません。</p>

    <div class="figure">
        <svg width="600" height="400" viewBox="0 0 600 400" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="50" y1="200" x2="550" y2="200" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="300" y1="30" x2="300" y2="370" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            
            <!-- X-axis Ticks and Labels -->
            <text x="300" y="215" font-size="10" text-anchor="middle">0</text>
            <text x="400" y="215" font-size="10" text-anchor="middle">$\pi/2$</text><line x1="400" y1="195" x2="400" y2="205" stroke="#333"/>
            <text x="500" y="215" font-size="10" text-anchor="middle">$\pi$</text><line x1="500" y1="195" x2="500" y2="205" stroke="#333"/>
            <text x="200" y="215" font-size="10" text-anchor="middle">$-\pi/2$</text><line x1="200" y1="195" x2="200" y2="205" stroke="#333"/>
            <text x="100" y="215" font-size="10" text-anchor="middle">$-\pi$</text><line x1="100" y1="195" x2="100" y2="205" stroke="#333"/>
            
            <!-- Y-axis Ticks and Labels -->
            <text x="290" y="105" font-size="10" text-anchor="end">1</text><line x1="295" y1="100" x2="305" y2="100" stroke="#333"/>
            <text x="290" y="305" font-size="10" text-anchor="end">-1</text><line x1="295" y1="300" x2="305" y2="300" stroke="#333"/>
            <text x="290" y="55" font-size="10" text-anchor="end">2</text><line x1="295" y1="50" x2="305" y2="50" stroke="#333"/>
            <text x="290" y="355" font-size="10" text-anchor="end">-2</text><line x1="295" y1="350" x2="305" y2="350" stroke="#333"/>

            <!-- Asymptotes for tan(x) -->
            <line x1="200" y1="30" x2="200" y2="370" stroke="lightgray" stroke-dasharray="4 2"/> <!-- x = -pi/2 -->
            <line x1="400" y1="30" x2="400" y2="370" stroke="lightgray" stroke-dasharray="4 2"/> <!-- x = pi/2 -->
            
            <!-- sin(x) in red -->
            <path d="M 100 200 C 150 100, 250 100, 300 200 S 350 300, 400 300 S 450 100, 500 200" stroke="red" fill="none" stroke-width="2" transform="scale(1, 0.5) translate(0, 200)"/>
            <!-- cos(x) in blue -->
            <path d="M 100 100 C 150 200, 250 200, 300 100 S 350 0, 400 0 S 450 200, 500 100" stroke="blue" fill="none" stroke-width="2" transform="scale(1, 0.5) translate(0, 200)"/>
            <!-- tan(x) in green -->
            <path d="M 201 370 C 230 200, 270 200, 299 30" stroke="green" fill="none" stroke-width="2"/>
            <path d="M 301 370 C 330 200, 370 200, 399 30" stroke="green" fill="none" stroke-width="2"/>
             <path d="M 50 370 C 80 200, 120 200, 199 30" stroke="green" fill="none" stroke-width="2" />
             <path d="M 401 370 C 430 200, 470 200, 549 30" stroke="green" fill="none" stroke-width="2" />


            <!-- Legend -->
            <rect x="480" y="35" width="70" height="60" fill="#fff" stroke="#ccc"/>
            <line x1="490" y1="50" x2="505" y2="50" stroke="red" stroke-width="2"/>
            <text x="510" y="55" font-size="10">sin(x)</text>
            <line x1="490" y1="65" x2="505" y2="65" stroke="blue" stroke-width="2"/>
            <text x="510" y="70" font-size="10">cos(x)</text>
            <line x1="490" y1="80" x2="505" y2="80" stroke="green" stroke-width="2"/>
            <text x="510" y="85" font-size="10">tan(x)</text>
        </svg>
        <figcaption>図2: $\sin(x)$, $\cos(x)$, $\tan(x)$ のグラフ</figcaption>
    </div>
    
    <div class="theorem">
        Thm: $\tan'(x) = \frac{1}{\cos^2 x} = \sec^2 x$
    </div>
    <div class="proof">
        Proof: $\tan x = \frac{\sin x}{\cos x}$ なので、商の微分公式 $(\frac{f}{g})' = \frac{f'g - fg'}{g^2}$ を用います。
        $f(x) = \sin x \implies f'(x) = \cos x$
        $g(x) = \cos x \implies g'(x) = -\sin x$
        よって、
        $$ \begin{aligned} (\tan x)' &= \frac{(\sin x)' \cos x - \sin x (\cos x)'}{(\cos x)^2} \\ &= \frac{\cos x \cdot \cos x - \sin x \cdot (-\sin x)}{\cos^2 x} \\ &= \frac{\cos^2 x + \sin^2 x}{\cos^2 x} \\ &= \frac{1}{\cos^2 x} \end{aligned} $$
        ここで $\sec x = \frac{1}{\cos x}$ なので、$\frac{1}{\cos^2 x} = \sec^2 x$ とも書けます。
    </div>

    <h2>2: 逆三角関数</h2>
    
    <h3>arcsin</h3>
    <div class="theorem">
        Thm: 任意の $a \in [-1,1]$ について、ある $y \in [-\pi/2, \pi/2]$ がただ一つ存在して、$\sin(y) = a$ となる。この $y$ を $\arcsin(a)$ と書く。
    </div>
    <div class="figure">
        <svg width="500" height="350" viewBox="0 0 500 350" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="50" y1="175" x2="450" y2="175" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="250" y1="30" x2="250" y2="320" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            
            <!-- X-axis Ticks and Labels -->
            <text x="245" y="190" font-size="10" text-anchor="end">0</text>
            <text x="350" y="190" font-size="10" text-anchor="middle">1</text><line x1="350" y1="170" x2="350" y2="180" stroke="#333"/>
            <text x="150" y="190" font-size="10" text-anchor="middle">-1</text><line x1="150" y1="170" x2="150" y2="180" stroke="#333"/>
            
            <!-- Y-axis Ticks and Labels -->
            <text x="240" y="70" font-size="10" text-anchor="end">$\pi/2$</text><line x1="245" y1="65" x2="255" y2="65" stroke="#333"/>
            <text x="240" y="280" font-size="10" text-anchor="end">$-\pi/2$</text><line x1="245" y1="285" x2="255" y2="285" stroke="#333"/>

            <!-- Line y=x -->
            <line x1="50" y1="320" x2="450" y2="30" stroke="lightgray" stroke-dasharray="4 2"/>
            
            <!-- sin(x) on [-pi/2, pi/2] (scaled to fit graph - map x: [-pi/2, pi/2] to y-axis like range, y: [-1,1] to x-axis like range for visual inverse) -->
            <!-- For sin(x) from y=-pi/2 to y=pi/2:  x_val = sin(y_val)
                 y_val from 285 (for -pi/2) to 65 (for pi/2)
                 x_coord = 250 + sin( (175-y_coord)/ (220/pi) ) * 100
                 y_coord = y_coord
            -->
            <path d="M 150 285 C 250 285, 150 65, 250 65" stroke="blue" fill="none" stroke-width="2"/> <!-- sin(y)=x, y in [-pi/2,pi/2] -->
            <!-- This is actually arcsin(x) -->
            <path d="M 150 285 Q 250 175, 350 65" stroke="red" fill="none" stroke-width="2"/> <!-- arcsin(x) -->
            
            <!-- Legend -->
            <rect x="350" y="280" width="100" height="40" fill="#fff" stroke="#ccc"/>
            <line x1="360" y1="295" x2="375" y2="295" stroke="red" stroke-width="2"/>
            <text x="380" y="300" font-size="10">y=arcsin(x)</text>
             <line x1="360" y1="310" x2="375" y2="310" stroke="lightgray" stroke-dasharray="2 1" stroke-width="2"/>
            <text x="380" y="315" font-size="10">y=x</text>
        </svg>
        <figcaption>図3: $y=\arcsin(x)$ のグラフ (赤) と $y=x$ (破線)</figcaption>
    </div>
    <div class="proof">
        Proof: $\sin(-\pi/2)=-1, \sin(\pi/2)=1$ であるので、中間値の定理より、任意の $a \in [-1,1]$ に対してある $y \in [-\pi/2, \pi/2]$ が存在して $\sin(y)=a$ となります。
        また、$\sin(x)$ は区間 $[-\pi/2, \pi/2]$ で単調増加します (導関数 $(\sin x)' = \cos x$ が $(-\pi/2, \pi/2)$ で正であるため)。したがって、$\sin(y_1) = \sin(y_2) = a$ ならば $y_1=y_2$ となり、このような $y$ は唯一存在します。
    </div>
    <div class="example">
        例:
        <ul>
            <li>$\arcsin(1/2) = \pi/6$  (なぜなら $\sin(\pi/6) = 1/2$ かつ $\pi/6 \in [-\pi/2, \pi/2]$)</li>
            <li>$\arcsin(-\sqrt{2}/2) = -\pi/4$ (なぜなら $\sin(-\pi/4) = -\sqrt{2}/2$ かつ $-\pi/4 \in [-\pi/2, \pi/2]$)</li>
            <li>$\arcsin(1) = \pi/2$ (なぜなら $\sin(\pi/2) = 1$ かつ $\pi/2 \in [-\pi/2, \pi/2]$)</li>
        </ul>
    </div>
    <p>$\log$ のときと同様に, $\arcsin(x)$ (定義域: $[-1,1]$)が $\sin(x)$ (定義域: $[-\pi/2, \pi/2]$) の逆関数になることが示されます。</p>
    <div class="theorem">
        Thm: $(\arcsin x)' = \frac{1}{\sqrt{1-x^2}}$  (ただし $x \in (-1,1)$)
    </div>
    <div class="proof">
        Proof: $y = \arcsin x$ とおくと、定義より $x = \sin y$ であり、$y \in [-\pi/2, \pi/2]$ です。
        $x = \sin y$ の両辺を $x$ で微分すると、合成関数の微分法より:
        $$ \frac{d}{dx}(x) = \frac{d}{dx}(\sin y) $$
        $$ 1 = \cos y \cdot \frac{dy}{dx} $$
        よって、$\cos y \neq 0$ のとき、
        $$ \frac{dy}{dx} = \frac{1}{\cos y} $$
        ここで、$y \in [-\pi/2, \pi/2]$ なので、$\cos y \ge 0$ です。したがって $\cos y = \sqrt{1-\sin^2 y}$ となります。
        $x = \sin y$ を代入すると、$\cos y = \sqrt{1-x^2}$。
        $y \in (-\pi/2, \pi/2)$ のとき (つまり $x \in (-1,1)$ のとき)、$\cos y > 0$ なので、
        $$ (\arcsin x)' = \frac{dy}{dx} = \frac{1}{\sqrt{1-x^2}} $$
    </div>

    <h3>arccos</h3>
    <p>同様に, $\cos(x)$ (定義域: $[0,\pi]$)の逆関数を $\arccos(x)$ (定義域: $[-1,1]$)と書きます。</p>
    <div class="figure">
        <svg width="500" height="350" viewBox="0 0 500 350" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="50" y1="175" x2="450" y2="175" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="250" y1="30" x2="250" y2="320" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            
            <!-- X-axis Ticks and Labels -->
            <text x="245" y="190" font-size="10" text-anchor="end">0</text>
            <text x="350" y="190" font-size="10" text-anchor="middle">1</text><line x1="350" y1="170" x2="350" y2="180" stroke="#333"/>
            <text x="150" y="190" font-size="10" text-anchor="middle">-1</text><line x1="150" y1="170" x2="150" y2="180" stroke="#333"/>
            
            <!-- Y-axis Ticks and Labels -->
            <text x="240" y="180" font-size="10" text-anchor="end">0</text>
            <text x="240" y="70" font-size="10" text-anchor="end">$\pi/2$</text><line x1="245" y1="65" x2="255" y2="65" stroke="#333"/> <!-- Should be pi/2 on y axis for arccos -->
            <text x="240" y="40" font-size="10" text-anchor="end">$\pi$</text><line x1="245" y1="35" x2="255" y2="35" stroke="#333"/> <!-- Should be pi on y axis for arccos -->
            <!-- Line y=x -->
            <line x1="50" y1="320" x2="450" y2="30" stroke="lightgray" stroke-dasharray="4 2"/>
            
            <!-- arccos(x) in red -->
            <!-- M x1 y_of_pi Q cx y_of_pi/2 L x-1 y_of_0  -->
            <path d="M 350 175 Q 250 65, 150 35" stroke="red" fill="none" stroke-width="2"/> <!-- arccos(x) from (1,0) to (-1, pi) passing through (0, pi/2) -->
            
            <!-- Legend -->
            <rect x="350" y="280" width="100" height="40" fill="#fff" stroke="#ccc"/>
            <line x1="360" y1="295" x2="375" y2="295" stroke="red" stroke-width="2"/>
            <text x="380" y="300" font-size="10">y=arccos(x)</text>
            <line x1="360" y1="310" x2="375" y2="310" stroke="lightgray" stroke-dasharray="2 1" stroke-width="2"/>
            <text x="380" y="315" font-size="10">y=x</text>
        </svg>
        <figcaption>図4: $y=\arccos(x)$ のグラフ (赤) と $y=x$ (破線)</figcaption>
    </div>
    <div class="formula">
        $(\arccos x)' = -\frac{1}{\sqrt{1-x^2}}$ (ただし $x \in (-1,1)$)
    </div>

    <h3>arctan</h3>
    <p>$\tan(x)$ (定義域 $(-\pi/2, \pi/2)$) の逆関数を $\arctan(x)$ (定義域 $(-\infty, \infty)$, 値域 $(-\pi/2, \pi/2)$) と定義します。</p>
    <div class="figure">
        <svg width="500" height="350" viewBox="0 0 500 350" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="50" y1="175" x2="450" y2="175" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="250" y1="30" x2="250" y2="320" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            
            <!-- X-axis Ticks and Labels -->
            <text x="245" y="190" font-size="10" text-anchor="end">0</text>
            <text x="350" y="190" font-size="10" text-anchor="middle">2</text><line x1="350" y1="170" x2="350" y2="180" stroke="#333"/>
            <text x="150" y="190" font-size="10" text-anchor="middle">-2</text><line x1="150" y1="170" x2="150" y2="180" stroke="#333"/>
            <text x="430" y="190" font-size="10" text-anchor="middle">x</text>
            
            <!-- Y-axis Ticks and Labels -->
            <text x="240" y="70" font-size="10" text-anchor="end">$\pi/2$</text><line x1="245" y1="65" x2="255" y2="65" stroke="#333"/>
            <text x="240" y="280" font-size="10" text-anchor="end">$-\pi/2$</text><line x1="245" y1="285" x2="255" y2="285" stroke="#333"/>
            <text x="240" y="35" font-size="10" text-anchor="end">y</text>

            <!-- Asymptotes for arctan(x) -->
            <line x1="50" y1="65" x2="450" y2="65" stroke="lightgray" stroke-dasharray="4 2"/> <!-- y = pi/2 -->
            <line x1="50" y1="285" x2="450" y2="285" stroke="lightgray" stroke-dasharray="4 2"/> <!-- y = -pi/2 -->
            
            <!-- arctan(x) in red -->
            <path d="M 50 280 C 150 290, 150 175, 250 175 C 350 175, 350 60, 450 70" stroke="red" fill="none" stroke-width="2"/>
            
            <!-- Legend -->
            <rect x="350" y="30" width="100" height="25" fill="#fff" stroke="#ccc"/>
            <line x1="360" y1="42" x2="375" y2="42" stroke="red" stroke-width="2"/>
            <text x="380" y="47" font-size="10">y=arctan(x)</text>
        </svg>
        <figcaption>図5: $y=\arctan(x)$ のグラフ (赤) と漸近線 $y=\pm \pi/2$ (破線)</figcaption>
    </div>
    <p>$\arctan(x)$ の微分は演習とします。結果は $(\arctan x)' = \frac{1}{1+x^2}$ です。</p>

    <h2>双曲線関数</h2>
    <h3>定義</h3>
    <div class="definition">
        双曲線関数は次のように定義されます:
        <ul>
            <li>双曲線余弦 (hyperbolic cosine): $\cosh x = \frac{e^x + e^{-x}}{2}$</li>
            <li>双曲線正弦 (hyperbolic sine): $\sinh x = \frac{e^x - e^{-x}}{2}$</li>
            <li>双曲線正接 (hyperbolic tangent): $\tanh x = \frac{\sinh x}{\cosh x} = \frac{e^x - e^{-x}}{e^x + e^{-x}}$</li>
        </ul>
    </div>
    <div class="figure">
        <svg width="400" height="300" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="40" y1="250" x2="360" y2="250" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="200" y1="30" x2="200" y2="280" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            <text x="195" y="265" font-size="10" text-anchor="end">0</text>
            <text x="205" y="155" font-size="10" text-anchor="start">1</text><line x1="195" y1="150" x2="205" y2="150" stroke="#333"/> <!-- y=1 for cosh(0) -->
            <text x="355" y="265" font-size="10" text-anchor="middle">x</text>
            <text x="205" y="35" font-size="10" text-anchor="start">y</text>
            <!-- cosh(x) -->
            <path d="M 40 200 C 100 150, 150 150, 200 150 C 250 150, 300 150, 360 200" stroke="purple" fill="none" stroke-width="2" transform="translate(0, -20) scale(1,0.5)"/>
            <text x="300" y="70" font-size="12" fill="purple">$y=\cosh x$</text>
        </svg>
        <figcaption>図6: $y=\cosh(x)$ のグラフ</figcaption>
    </div>
    <div class="figure">
        <svg width="400" height="300" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="40" y1="150" x2="360" y2="150" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="200" y1="30" x2="200" y2="270" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            <text x="195" y="165" font-size="10" text-anchor="end">0</text>
            <text x="355" y="165" font-size="10" text-anchor="middle">x</text>
            <text x="205" y="35" font-size="10" text-anchor="start">y</text>
            <!-- sinh(x) -->
            <path d="M 40 250 C 150 250, 150 50, 200 150 C 250 50, 250 50, 360 50" stroke="orange" fill="none" stroke-width="2"/>
             <text x="300" y="70" font-size="12" fill="orange">$y=\sinh x$</text>
        </svg>
        <figcaption>図7: $y=\sinh(x)$ のグラフ</figcaption>
    </div>
    <div class="figure">
        <svg width="400" height="300" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
            <rect width="100%" height="100%" fill="#fff"/>
            <!-- Axes -->
            <line x1="40" y1="150" x2="360" y2="150" stroke="#333" stroke-width="1"/> <!-- X-axis -->
            <line x1="200" y1="30" x2="200" y2="270" stroke="#333" stroke-width="1"/>  <!-- Y-axis -->
            <text x="195" y="165" font-size="10" text-anchor="end">0</text>
            <text x="205" y="85" font-size="10" text-anchor="start">1</text><line x1="195" y1="80" x2="205" y2="80" stroke="#333"/>
            <text x="205" y="225" font-size="10" text-anchor="start">-1</text><line x1="195" y1="220" x2="205" y2="220" stroke="#333"/>
            <text x="355" y="165" font-size="10" text-anchor="middle">x</text>
            <text x="205" y="35" font-size="10" text-anchor="start">y</text>
            <!-- Asymptotes for tanh(x) -->
            <line x1="40" y1="80" x2="360" y2="80" stroke="lightgray" stroke-dasharray="4 2"/> <!-- y = 1 -->
            <line x1="40" y1="220" x2="360" y2="220" stroke="lightgray" stroke-dasharray="4 2"/> <!-- y = -1 -->
            <!-- tanh(x) -->
            <path d="M 40 215 C 150 220, 150 80, 200 150 C 250 80, 250 75, 360 85" stroke="brown" fill="none" stroke-width="2"/>
            <text x="300" y="120" font-size="12" fill="brown">$y=\tanh x$</text>
        </svg>
        <figcaption>図8: $y=\tanh(x)$ のグラフ</figcaption>
    </div>

    <h3>三角関数との関係 (性質)</h3>
    <p>双曲線関数には三角関数に似た以下の性質があります。</p>
    <div class="formula">
        $(\cosh x)' = \sinh x
    </div>
    <div class="formula">
        $(\sinh x)' = \cosh x
    </div>
    <div class="formula">
        \cosh^2 x - \sinh^2 x = 1
    </div>
    <div class="proof">
        Proof of $\cosh^2 x - \sinh^2 x = 1$:
        $$ \begin{aligned} \cosh^2 x - \sinh^2 x &= \left(\frac{e^x + e^{-x}}{2}\right)^2 - \left(\frac{e^x - e^{-x}}{2}\right)^2 \\ &= \frac{e^{2x} + 2e^x e^{-x} + e^{-2x}}{4} - \frac{e^{2x} - 2e^x e^{-x} + e^{-2x}}{4} \\ &= \frac{e^{2x} + 2 + e^{-2x} - (e^{2x} - 2 + e^{-2x})}{4} \\ &= \frac{e^{2x} + 2 + e^{-2x} - e^{2x} + 2 - e^{-2x}}{4} \\ &= \frac{4}{4} = 1 \end{aligned} $$
    </div>

    <h2>高階微分</h2>
    <h3>定義</h3>
    <div class="definition">
        関数 $f(x)$ の導関数 $f'(x)$ が再び微分可能であるとき、その導関数 $(f'(x))'$ を $f''(x)$ または $\frac{d^2f}{dx^2}$ と書き、$f(x)$ の<strong>第二次導関数</strong>といいます。
        $$ f''(x) = (f'(x))' = \lim_{h\to 0} \frac{f'(x+h)-f'(x)}{h} $$
        同様に、$f'''(x) = (f''(x))'$ (第三次導関数)、一般に $n$ 次導関数は $f^{(n)}(x) = (f^{(n-1)}(x))'$ と定義されます。ここで $f^{(0)}(x) = f(x)$ です。
    </div>
    <div class="example">
    例1: $f(x) = x^3$ の $n$ 階微分を求めよ。
    <p>$f(x) = x^3$</p>
    <p>$f'(x) = 3x^2$</p>
    <p>$f''(x) = 6x$</p>
    <p>$f'''(x) = 6$</p>
    <p>$f^{(4)}(x) = 0$</p>
    <p>$n \ge 4$ のとき、$f^{(n)}(x) = 0$</p>
    <p>したがって、</p>
    $f^{(n)}(x) = \begin{cases} x^3 & n=0 \\ 3x^2 & n=1 \\ 6x & n=2 \\ 6 & n=3 \\ 0 & n \ge 4 \end{cases}$
    </div>
    <div class="example">
    例2: $f(x) = x^3+2x+1$ の $n$ 回微分
    <p>$f(x) = x^3 + 2x + 1$</p>
    <p>$f'(x) = 3x^2 + 2$</p>
    <p>$f''(x) = 6x$</p>
    <p>$f'''(x) = 6$</p>
    <p>$f^{(4)}(x) = 0$</p>
    <p>$n \ge 4$ のとき、$f^{(n)}(x) = 0$</p>
    </div>

    <h3>例</h3>
    <div class="example">
    $f(x) = \cos x$ の $n$ 階微分を求めよ。
    <p>$f^{(0)}(x) = \cos x = \cos(x + 0 \cdot \pi/2)$</p>
    <p>$f'(x) = -\sin x = \cos(x + \pi/2)$</p>
    <p>$f''(x) = -\cos x = \cos(x + 2 \cdot \pi/2)$</p>
    <p>$f'''(x) = \sin x = \cos(x + 3 \cdot \pi/2)$</p>
    <p>$f^{(4)}(x) = \cos x = \cos(x + 4 \cdot \pi/2)$</p>
    <p>このパターンから、一般に $n$ 階微分は</p>
    <div class="formula">
        $f^{(n)}(x) = \cos(x + \frac{n\pi}{2})$
    </div>
    </div>

    <h2>無限級数</h2>
    <h3>級数</h3>
    <div class="definition">
    数列 $\{a_k\}_{k=0}^\infty$ を考える。初項から第 $n$ 項までの和を $S_n = \sum_{k=0}^n a_k$ とする。
    この部分和の列 $S_n$ が $n \to \infty$ のときある値 $S$ に収束するならば、級数 $\sum_{k=0}^\infty a_k$ は収束するといい、その和を $S$ と書く。
    $$ \sum_{k=0}^\infty a_k = \lim_{n\to\infty} S_n = \lim_{n\to\infty} \sum_{k=0}^n a_k $$
    (収束・発散の厳密な議論は後の回で行います。)
    </div>
    <div class="example">
    例1: $x \in (-1,1)$ について、$\sum_{k=0}^\infty x^k = \frac{1}{1-x}$ が成り立つ。
    <div class="proof">
    Proof: これは等比級数です。部分和 $S_n = \sum_{k=0}^n x^k = 1 + x + x^2 + \dots + x^n$ を考えます。
    $x \neq 1$ のとき、$S_n = \frac{1-x^{n+1}}{1-x}$ です。
    $|x| < 1$ (すなわち $x \in (-1,1)$) のとき、$\lim_{n\to\infty} x^{n+1} = 0$ です。
    したがって、
    $$ \lim_{n\to\infty} S_n = \lim_{n\to\infty} \frac{1-x^{n+1}}{1-x} = \frac{1-0}{1-x} = \frac{1}{1-x} $$
    </div>
    </div>
    <div class="example">
    例2: (証明なし) $\sum_{n=1}^\infty \frac{1}{n^2} = 1 + \frac{1}{4} + \frac{1}{9} + \dots = \frac{\pi^2}{6}$ が成り立つ。
    </div>
    <div class="example">
    例3: $\sum_{n=0}^\infty (-1)^n = 1 - 1 + 1 - 1 + \dots$ は収束しない。
    <p>部分和は $S_0 = 1$, $S_1 = 0$, $S_2 = 1$, $S_3 = 0, \dots$ となり、$1$ と $0$ の間を振動するため、一定の値に収束しません。</p>
    </div>

    <h3>無限級数 (べき級数)</h3>
    <div class="definition">
    数列 $\{a_k\}_{k=0}^\infty$ が与えられたとき、変数 $x$ を含む級数
    $$ f(x) = \sum_{k=0}^\infty a_k x^k = a_0 + a_1 x + a_2 x^2 + \dots $$
    を<strong>べき級数</strong> (power series) といいます。
    この級数が収束するような $x$ の集合 (区間 $I=(a,b)$ など) において、この級数は関数 $f(x)$ を定義します。
    </div>
    <div class="example">
    例1: 無限級数 $f(x) = \sum_{n=0}^\infty x^n$ は区間 $(-1,1)$ で収束し、$f(x) = \frac{1}{1-x}$ に等しい。
    </div>
    <div class="example">
    例2: 無限級数 $f(x) = \sum_{n=1}^\infty n x^{n-1}$ は区間 $(-1,1)$ で収束し、$f(x) = \frac{1}{(1-x)^2}$ に等しい。
    <p>これは、例1の級数 $g(x) = \sum_{n=0}^\infty x^n = \frac{1}{1-x}$ を項別微分することで得られます。
    $g'(x) = \frac{d}{dx} \left(\sum_{n=0}^\infty x^n\right) = \sum_{n=1}^\infty n x^{n-1}$
    また、$g'(x) = \frac{d}{dx} \left(\frac{1}{1-x}\right) = \frac{d}{dx} (1-x)^{-1} = -1 \cdot (1-x)^{-2} \cdot (-1) = \frac{1}{(1-x)^2}$
    </p>
    </div>

    <h2>テイラー多項式</h2>
    <h3>ニュートンの考察</h3>
    <p>$f(x)$ が何回でも微分可能な関数であるとします。もし $f(x)$ が $x=0$ の周りでべき級数
    $$ f(x) = \sum_{n=0}^\infty a_n x^n = a_0 + a_1 x + a_2 x^2 + a_3 x^3 + \dots $$
    と表されるとしたら、係数 $a_k$ は何になるでしょうか？</p>
    <p>答え: $a_n = \frac{f^{(n)}(0)}{n!}$ とすればよい。</p>
    <p>実際、
    $f(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3 + \dots$
    $x=0$ を代入すると、$f(0) = a_0$。</p>
    <p>$f'(x) = a_1 + 2a_2 x + 3a_3 x^2 + \dots$
    $x=0$ を代入すると、$f'(0) = a_1$。</p>
    <p>$f''(x) = 2a_2 + 3 \cdot 2 a_3 x + \dots$
    $x=0$ を代入すると、$f''(0) = 2a_2 \implies a_2 = \frac{f''(0)}{2!}$。</p>
    <p>$f'''(x) = 3 \cdot 2 \cdot 1 a_3 + \dots$
    $x=0$ を代入すると、$f'''(0) = 3!a_3 \implies a_3 = \frac{f'''(0)}{3!}$。</p>
    <p>一般に、$f^{(n)}(0) = n! a_n$ となるので、$a_n = \frac{f^{(n)}(0)}{n!}$ です。</p>
    <div class="definition">
    与えられた関数 $f(x)$ (無限回微分可能とする) に対し、べき級数
    $$ \sum_{n=0}^\infty \frac{f^{(n)}(0)}{n!}x^n $$
    を、$f(x)$ の $x=0$ における<strong>テイラー展開</strong> (または<strong>マクローリン展開</strong>) と呼びます。
    </div>

    <h3>テイラー多項式</h3>
    <div class="definition">
    関数 $f(x)$ が $n$ 回微分可能なとき、$f(x)$ の $x=0$ における $n$ 次<strong>テイラー多項式</strong> (または<strong>マクローリン多項式</strong>) $T_n(x)$ を次のように定義します。
    $$ T_n(x) = \sum_{k=0}^n \frac{f^{(k)}(0)}{k!}x^k = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \dots + \frac{f^{(n)}(0)}{n!}x^n $$
    これはテイラー展開の最初の $n+1$ 項 (つまり $n$ 次までの項) を取ったものです。
    </div>

    <div class="example">
    例1: $f(x) = e^x$ の $n$ 次テイラー多項式。
    <p>$f(x) = e^x$ の導関数は常に $f^{(k)}(x) = e^x$ です。
    したがって、$f^{(k)}(0) = e^0 = 1$ です (すべての $k \ge 0$ について)。
    よって、$e^x$ の $n$ 次テイラー多項式は、
    $$ T_n(x) = \sum_{k=0}^n \frac{1}{k!}x^k = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \dots + \frac{x^n}{n!} $$
    </p>
    </div>
    <div class="example">
    例2: $f(x) = \cos x$ の $n$ 次テイラー多項式。
    <p>$f(x) = \cos x$ の導関数は以下のようになります:
    $f^{(0)}(x) = \cos x \implies f^{(0)}(0) = 1$
    $f^{(1)}(x) = -\sin x \implies f^{(1)}(0) = 0$
    $f^{(2)}(x) = -\cos x \implies f^{(2)}(0) = -1$
    $f^{(3)}(x) = \sin x \implies f^{(3)}(0) = 0$
    $f^{(4)}(x) = \cos x \implies f^{(4)}(0) = 1$
    ...というパターンが繰り返されます。</p>
    <p>係数 $\frac{f^{(k)}(0)}{k!}$ は、
    $k=0: \frac{1}{0!} = 1$
    $k=1: \frac{0}{1!} = 0$
    $k=2: \frac{-1}{2!} = -\frac{1}{2!}$
    $k=3: \frac{0}{3!} = 0$
    $k=4: \frac{1}{4!} = \frac{1}{4!}$
    ...</p>
    <p>したがって、$\cos x$ の $n$ 次テイラー多項式 $T_n(x)$ は、
    $$ T_n(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \dots + (-1)^m \frac{x^{2m}}{(2m)!} $$
    ここで、$2m \le n$ を満たす最大の整数 $m$ まで項を含みます。より正確には、
    $$ T_n(x) = \sum_{m=0}^{\lfloor n/2 \rfloor} \frac{(-1)^m}{(2m)!}x^{2m} $$
    例えば、$n=5$ の場合、$T_5(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!}$ となります。
    </p>
    </div>

</body>
</html>